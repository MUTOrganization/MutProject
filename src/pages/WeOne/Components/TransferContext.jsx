import React, { createContext, useContext, useState, useEffect } from 'react';
import fetchProtectedData from '../../../../utils/fetchData';
import { useAppContext } from '../../../contexts/AppContext';
import { URLS } from '../../../config';

const TransferContext = createContext();

export const TransferProvider = ({ children }) => {
    const [selectedUsers, setSelectedUsers] = useState([]);
    const [selectedRemark, setSelectedRemark] = useState('');
    const [users, setUsers] = useState([]);
    const [isLoading, setIsLoading] = useState(false);
    const [userPoints, setUserPoints] = useState({ total_points: 0, total_coins: 0 });
    const [isLoadingPoints, setIsLoadingPoints] = useState(false);
    const [lastestTransfers, setLastestTransfers] = useState([]); // State à¹ƒà¸«à¸¡à¹ˆ
    const [isLoadingLastestTransfers, setIsLoadingLastestTransfers] = useState(false);
    const currentUser = useAppContext();

    const remarks = [
        { type: "à¸”à¹‰à¸§à¸¢à¸„à¸§à¸²à¸¡à¸£à¸±à¸ ðŸ’˜", description: "à¹„à¸Ÿà¸£à¸±à¸à¸¡à¸±à¸™à¸£à¹‰à¸­à¸™à¹à¸£à¸‡à¸ˆà¸™à¸¥à¸§à¸à¸«à¸±à¸§à¹ƒà¸ˆ! à¸™à¹‰à¸³à¸—à¸°à¹€à¸¥à¸à¹‡à¸¢à¸±à¸‡à¸”à¸±à¸šà¹„à¸¡à¹ˆà¹„à¸”à¹‰ à¸«à¸§à¸²à¸™à¹€à¸ˆà¸µà¹Šà¸¢à¸š!" },
        { type: "à¸”à¹‰à¸§à¸¢à¸„à¸§à¸²à¸¡à¹€à¸šà¸·à¹ˆà¸­ ðŸ¥´", description: "à¸Šà¸µà¸§à¸´à¸•à¸¡à¸±à¸™à¹€à¸‹à¹‡à¸‡à¹€à¸à¸´à¸™à¸šà¸£à¸£à¸¢à¸²à¸¢ à¸„à¸°à¹à¸™à¸™à¸à¹‡à¹€à¸«à¸¡à¸·à¸­à¸™à¸à¸­à¸‡à¸œà¸±à¸ à¹„à¸¡à¹ˆà¸£à¸¹à¹‰à¸ˆà¸°à¸ªà¸™à¹ƒà¸ˆà¹„à¸›à¸—à¸³à¹„à¸¡!" },
        { type: "à¸”à¹‰à¸§à¸¢à¸„à¸§à¸²à¸¡à¸žà¹ˆà¸²à¸¢à¹à¸žà¹‰ ðŸ¤•", description: "à¹à¸žà¹‰à¹à¸¥à¹‰à¸§à¹„à¸‡? à¹„à¸¡à¹ˆà¸£à¹‰à¸­à¸‡à¸«à¸£à¸­à¸ à¹à¸„à¹ˆà¸«à¸±à¸§à¹ƒà¸ˆà¸«à¸±à¸à¹€à¸›à¹‡à¸™à¹€à¸ªà¸µà¹ˆà¸¢à¸‡à¹† à¹€à¸­à¸‡... à¹€à¸ˆà¹‡à¸šà¸ˆà¸µà¹Šà¸”à¹€à¸¥à¸¢!" },
        { type: "à¸”à¹‰à¸§à¸¢à¸„à¸§à¸²à¸¡à¸ªà¸±à¸šà¸ªà¸™ ðŸ¤¯", description: "à¸™à¸µà¹ˆà¹€à¸£à¸²à¸—à¸³à¸­à¸°à¹„à¸£à¸­à¸¢à¸¹à¹ˆ? à¸«à¸¥à¸‡à¸¡à¸²à¹à¸šà¸šà¸‡à¸‡à¹† à¹à¸•à¹ˆà¸­à¸¢à¹ˆà¸²à¸‡à¸™à¹‰à¸­à¸¢à¸à¹‡à¸¢à¸±à¸‡à¸«à¸²à¸¢à¹ƒà¸ˆà¸­à¸¢à¸¹à¹ˆà¸¥à¸°à¸à¸±à¸™!" },
        { type: "à¸”à¹‰à¸§à¸¢à¸„à¸§à¸²à¸¡à¸¢à¸´à¸™à¸”à¸µ ðŸ¥³", description: "à¹€à¸®à¹‰à¸¢! à¸”à¸µà¹ƒà¸ˆà¹à¸šà¸šà¹„à¸¡à¹ˆà¹„à¸«à¸§à¹à¸¥à¹‰à¸§ à¹€à¸«à¸¡à¸·à¸­à¸™à¸–à¸¹à¸à¸«à¸§à¸¢à¸£à¸²à¸‡à¸§à¸±à¸¥à¸—à¸µà¹ˆ 1 à¹à¸•à¹ˆà¹„à¸¡à¹ˆà¸¡à¸µà¹€à¸¥à¸‚à¸šà¸­à¸!" },
        { type: "à¸”à¹‰à¸§à¸¢à¸„à¸§à¸²à¸¡à¹€à¸«à¹‡à¸™à¹ƒà¸ˆ ðŸ˜”", description: "à¸¡à¸²à¸™à¸µà¹ˆà¸¡à¸² à¹ƒà¸«à¹‰à¸à¸­à¸”à¸—à¸µ! à¹€à¸žà¸£à¸²à¸°à¸Šà¸µà¸§à¸´à¸•à¸¡à¸±à¸™à¹„à¸¡à¹ˆà¸‡à¹ˆà¸²à¸¢ à¹à¸•à¹ˆà¹€à¸£à¸²à¸ˆà¸°à¹„à¸¡à¹ˆà¸—à¸´à¹‰à¸‡à¸„à¸¸à¸“à¹à¸™à¹ˆà¸™à¸­à¸™!" },
        { type: "à¸”à¹‰à¸§à¸¢à¸„à¸§à¸²à¸¡à¸›à¸£à¸°à¸Šà¸”à¸›à¸£à¸°à¸Šà¸±à¸™ ðŸ˜", description: "à¸­à¹‰à¸­ à¹€à¸à¹ˆà¸‡à¸™à¸°? à¹€à¸à¹ˆà¸‡à¸ˆà¸£à¸´à¸‡à¹† à¸„à¸°à¹à¸™à¸™à¸­à¸°à¹„à¸£à¹à¸šà¸šà¸™à¸µà¹‰ à¸„à¸™à¸£à¸§à¸¢à¹„à¸¡à¹ˆà¹à¸„à¸£à¹Œà¸«à¸£à¸­à¸! à¸«à¸¶!" },
        { type: "à¸”à¹‰à¸§à¸¢à¸„à¸§à¸²à¸¡à¸Šà¸·à¹ˆà¸™à¸Šà¸¡ âœ¨", description: "à¸ªà¸¸à¸”à¸›à¸±à¸‡à¹„à¸›à¹€à¸¥à¸¢à¹à¸¡à¹ˆ! à¸„à¸¸à¸“à¸„à¸·à¸­à¹„à¸Ÿà¸¥à¸¸à¸à¸žà¸£à¸¶à¹ˆà¸šà¸à¸¥à¸²à¸‡à¹€à¸§à¸—à¸µ à¸Šà¸™à¸°à¹ƒà¸ˆà¹„à¸›à¹€à¸¥à¸¢à¸ªà¸´à¸„à¸°!" },
        { type: "à¸”à¹‰à¸§à¸¢à¸„à¸§à¸²à¸¡à¸‚à¸µà¹‰à¹€à¸à¸µà¸¢à¸ˆ ðŸ˜´", description: "à¸•à¸·à¹ˆà¸™à¸¡à¸²à¸—à¸³à¸„à¸°à¹à¸™à¸™à¸¢à¸±à¸‡à¹€à¸«à¸™à¸·à¹ˆà¸­à¸¢à¹€à¸¥à¸¢ à¸‚à¸­à¹à¸›à¹Šà¸šà¸«à¸™à¸¶à¹ˆà¸‡à¸™à¸°! à¹€à¸«à¸™à¸·à¹ˆà¸­à¸¢à¸¡à¸²à¸à¸ˆà¸£à¸´à¸‡à¹†!" },
        { type: "à¸”à¹‰à¸§à¸¢à¸„à¸§à¸²à¸¡à¸«à¸´à¸§à¹‚à¸«à¸¢ ðŸ”", description: "à¸„à¸°à¹à¸™à¸™à¸­à¸°à¹„à¸£à¹„à¸¡à¹ˆà¸£à¸¹à¹‰ à¹à¸•à¹ˆà¸•à¸­à¸™à¸™à¸µà¹‰à¸­à¸¢à¸²à¸à¸à¸´à¸™à¹€à¸šà¸­à¸£à¹Œà¹€à¸à¸­à¸£à¹Œà¸¡à¸²à¸à¸à¸!" },
        { type: "à¸”à¹‰à¸§à¸¢à¸„à¸§à¸²à¸¡à¸«à¸¡à¸±à¹ˆà¸™à¹„à¸ªà¹‰ ðŸ™„", description: "à¸«à¸¶ à¹€à¸à¹ˆà¸‡à¹€à¸™à¸­à¸°! à¹à¸ˆà¸à¸„à¸°à¹à¸™à¸™à¹à¸šà¸šà¹„à¸¡à¹ˆà¸„à¸´à¸”à¹€à¸¥à¸¢... à¸«à¸¡à¸±à¹ˆà¸™à¹„à¸ªà¹‰à¸¡à¸²à¸!" },
        { type: "à¸”à¹‰à¸§à¸¢à¸„à¸§à¸²à¸¡à¸£à¸°à¸—à¸¶à¸à¹ƒà¸ˆ ðŸ˜¬", description: "à¸™à¸µà¹ˆà¸¡à¸±à¸™à¹€à¸à¸¡à¸Šà¸µà¸§à¸´à¸•! à¸„à¸°à¹à¸™à¸™à¸™à¸µà¹‰à¸ˆà¸°à¸žà¸¥à¸´à¸à¸Šà¸°à¸•à¸²à¸«à¸£à¸·à¸­à¸žà¸±à¸‡à¸—à¸¸à¸à¸­à¸¢à¹ˆà¸²à¸‡à¸à¹‡à¹„à¸”à¹‰!" },
        { type: "à¸”à¹‰à¸§à¸¢à¸„à¸§à¸²à¸¡à¹€à¸ªà¸µà¸¢à¸”à¸²à¸¢ ðŸ¥¹", description: "à¹‚à¸–à¹ˆ! à¸„à¸°à¹à¸™à¸™à¸«à¸²à¸¢à¹„à¸›à¹ƒà¸™à¸­à¸²à¸à¸²à¸¨ à¸ˆà¸°à¸£à¹‰à¸­à¸‡à¹„à¸«à¹‰à¹à¸¥à¹‰à¸§!" },
        { type: "à¸”à¹‰à¸§à¸¢à¸„à¸§à¸²à¸¡à¸­à¸¥à¸±à¸‡à¸à¸²à¸£ âœ¨", description: "à¸„à¸°à¹à¸™à¸™à¸™à¸µà¹‰à¸¢à¸´à¹ˆà¸‡à¹ƒà¸«à¸à¹ˆà¹€à¸«à¸¡à¸·à¸­à¸™à¸ªà¸£à¹‰à¸²à¸‡à¸›à¸£à¸²à¸ªà¸²à¸—à¹€à¸¥à¸¢! à¸¡à¸µà¸•à¸±à¸‡à¸„à¹Œà¸à¹‡à¹à¸ˆà¸à¹† à¹„à¸›à¸ªà¸´!" },
        { type: "à¸”à¹‰à¸§à¸¢à¸„à¸§à¸²à¸¡à¸‚à¸µà¹‰à¹€à¸¥à¹ˆà¸™ ðŸ˜œ", description: "à¸„à¸°à¹à¸™à¸™à¸™à¸µà¹‰à¹„à¸¡à¹ˆà¸¡à¸µà¸­à¸°à¹„à¸£à¸ˆà¸£à¸´à¸‡à¸ˆà¸±à¸‡! à¹à¸„à¹ˆà¹ƒà¸«à¹‰à¹€à¸žà¸£à¸²à¸°à¸­à¸¢à¸²à¸à¹à¸à¸¥à¹‰à¸‡!" },
        { type: "à¸”à¹‰à¸§à¸¢à¸„à¸§à¸²à¸¡à¸„à¸´à¸”à¸–à¸¶à¸‡ ðŸ¥¹", description: "à¸„à¸°à¹à¸™à¸™à¸™à¸µà¹‰à¸ªà¹ˆà¸‡à¸¡à¸²à¹ƒà¸«à¹‰ à¹€à¸žà¸£à¸²à¸°à¸„à¸´à¸”à¸–à¸¶à¸‡à¹à¸šà¸šà¸ªà¸¸à¸”à¸«à¸±à¸§à¹ƒà¸ˆ!" },
        { type: "à¸”à¹‰à¸§à¸¢à¸„à¸§à¸²à¸¡à¸¥à¸¸à¹‰à¸™à¸£à¸°à¸—à¸¶à¸ ðŸŽ²", description: "à¸„à¸°à¹à¸™à¸™à¸™à¸µà¹‰à¹€à¸«à¸¡à¸·à¸­à¸™à¸à¸²à¸£à¸žà¸™à¸±à¸™ à¹„à¸¡à¹ˆà¸£à¸¹à¹‰à¸ˆà¸°à¸£à¸­à¸”à¹„à¸«à¸¡ à¹à¸•à¹ˆà¸¥à¸¸à¹‰à¸™à¸—à¸¸à¸à¸§à¸´à¸™à¸²à¸—à¸µ!" },
        { type: "à¸”à¹‰à¸§à¸¢à¸„à¸§à¸²à¸¡à¸•à¸·à¹ˆà¸™à¹€à¸•à¹‰à¸™ ðŸš€", description: "à¹‚à¸­à¹‚à¸«! à¸•à¸·à¹ˆà¸™à¹€à¸•à¹‰à¸™à¹à¸šà¸šà¸™à¸µà¹‰à¹€à¸«à¸¡à¸·à¸­à¸™à¸‚à¸¶à¹‰à¸™à¸ˆà¸£à¸§à¸”à¹„à¸›à¸”à¸²à¸§à¸­à¸±à¸‡à¸„à¸²à¸£à¹€à¸¥à¸¢!" },
        { type: "à¸”à¹‰à¸§à¸¢à¸„à¸§à¸²à¸¡à¸­à¸´à¹ˆà¸¡à¹€à¸­à¸¡ ðŸ¥°", description: "à¸„à¸°à¹à¸™à¸™à¸™à¸µà¹‰à¹€à¸«à¸¡à¸·à¸­à¸™à¹„à¸­à¸•à¸´à¸¡à¸«à¸§à¸²à¸™à¹€à¸¢à¹‡à¸™ à¸Šà¸·à¹ˆà¸™à¹ƒà¸ˆà¸—à¸µà¹ˆà¸ªà¸¸à¸”!" },
        { type: "à¸”à¹‰à¸§à¸¢à¸„à¸§à¸²à¸¡à¸¡à¸¶à¸™à¸‡à¸‡ ðŸ¤”", description: "à¸„à¸°à¹à¸™à¸™à¸™à¸µà¹‰à¸¡à¸²à¸ˆà¸²à¸à¹„à¸«à¸™? à¸­à¸·à¸¡... à¸„à¸´à¸”à¹„à¸¡à¹ˆà¸­à¸­à¸ à¹à¸•à¹ˆà¸§à¹ˆà¸²à¹€à¸­à¸²à¹„à¸›!" },
        { type: "à¸”à¹‰à¸§à¸¢à¸„à¸§à¸²à¸¡à¸£à¸§à¸¢à¸¥à¹‰à¸™ ðŸ’Ž", description: "à¸„à¸°à¹à¸™à¸™à¸™à¸µà¹‰à¹€à¸«à¸¡à¸·à¸­à¸™à¹€à¸¨à¸©à¹€à¸‡à¸´à¸™à¸—à¸­à¸™... à¹à¸ˆà¸à¹€à¸¥à¹ˆà¸™à¹† à¹„à¸¡à¹ˆà¸„à¸´à¸”à¸¡à¸²à¸!" },
        { type: "à¸”à¹‰à¸§à¸¢à¸„à¸§à¸²à¸¡à¸­à¸´à¸™à¸”à¸µà¹‰ ðŸ§¢", description: "à¸„à¸°à¹à¸™à¸™à¸™à¸µà¹‰à¸¡à¸µà¸„à¸§à¸²à¸¡à¸«à¸¡à¸²à¸¢à¹€à¸‰à¸žà¸²à¸°à¸•à¸±à¸§ à¹€à¸­à¸²à¹„à¸›à¹€à¸¥à¸¢ à¹à¸•à¹ˆà¸„à¸¸à¸“à¹„à¸¡à¹ˆà¸¡à¸µà¸—à¸²à¸‡à¹€à¸‚à¹‰à¸²à¹ƒà¸ˆ!" },
        { type: "à¸”à¹‰à¸§à¸¢à¸„à¸§à¸²à¸¡à¸®à¸¶à¸à¹€à¸«à¸´à¸¡ ðŸ’ª", description: "à¹„à¸Ÿà¹ƒà¸™à¸•à¸±à¸§à¸¡à¸±à¸™à¸¥à¸¸à¸à¹‚à¸Šà¸™! à¹à¸ˆà¸à¸„à¸°à¹à¸™à¸™à¹à¸šà¸šà¹„à¸¡à¹ˆà¹à¸„à¸£à¹Œà¹‚à¸¥à¸!" },
        { type: "à¸”à¹‰à¸§à¸¢à¸„à¸§à¸²à¸¡à¹€à¸œà¹‡à¸” ðŸŒ¶", description: "à¸„à¸°à¹à¸™à¸™à¸™à¸µà¹‰à¹€à¸œà¹‡à¸”à¸£à¹‰à¸­à¸™à¹€à¸«à¸¡à¸·à¸­à¸™à¸žà¸£à¸´à¸à¸ªà¸´à¸šà¹€à¸¡à¹‡à¸”! à¸£à¸±à¸šà¹„à¸›à¸‹à¸µà¹‰à¸”à¹€à¸¥à¸¢!" },
        { type: "à¸”à¹‰à¸§à¸¢à¸„à¸§à¸²à¸¡à¸‚à¸™à¸¥à¸¸à¸ ðŸ«£", description: "à¹‚à¸­à¹‰à¹‚à¸«! à¸„à¸°à¹à¸™à¸™à¸™à¸µà¹‰à¸—à¸³à¹€à¸­à¸²à¸‚à¸™à¸¥à¸¸à¸à¹€à¸à¸£à¸µà¸¢à¸§à¹€à¸¥à¸¢... à¸£à¸±à¸šà¹„à¸›à¹à¸šà¸šà¸‡à¸‡à¹†!" },
        { type: "à¸”à¹‰à¸§à¸¢à¸„à¸§à¸²à¸¡à¹€à¸§à¸´à¹ˆà¸™à¹€à¸§à¹‰à¸­ ðŸŽ­", description: "à¸„à¸°à¹à¸™à¸™à¸™à¸µà¹‰à¸¡à¸²à¸ˆà¸²à¸à¸à¸²à¸£à¹€à¸§à¸´à¹ˆà¸™à¹€à¸§à¹‰à¸­à¸ˆà¸™à¹€à¸à¸´à¸™à¹€à¸šà¸­à¸£à¹Œ à¹à¸„à¹ˆà¹ƒà¸«à¹‰à¹€à¸žà¸£à¸²à¸°à¸§à¹ˆà¸²à¸‡à¸ˆà¸±à¸”!" },
        { type: "à¸”à¹‰à¸§à¸¢à¸„à¸§à¸²à¸¡à¸šà¹‰à¸²à¸šà¸­ ðŸ¤ª", description: "à¸„à¸°à¹à¸™à¸™à¸™à¸µà¹‰à¹„à¸¡à¹ˆà¸¡à¸µà¹€à¸«à¸•à¸¸à¸œà¸¥! à¹à¸„à¹ˆà¸šà¹‰à¸²à¸à¹‡à¹à¸ˆà¸!" },
        { type: "à¸”à¹‰à¸§à¸¢à¸„à¸§à¸²à¸¡à¸ªà¸‡à¸ªà¸±à¸¢ ðŸ¤¨", description: "à¸„à¸°à¹à¸™à¸™à¸™à¸µà¹‰à¹à¸ˆà¸à¹„à¸›à¹à¸¥à¹‰à¸§à¸—à¸³à¹„à¸¡à¸•à¹‰à¸­à¸‡à¹à¸ˆà¸? à¹à¸•à¹ˆà¸à¹‡à¹à¸ˆà¸à¹„à¸›à¹à¸¥à¹‰à¸§!" },
        { type: "à¸”à¹‰à¸§à¸¢à¸„à¸§à¸²à¸¡à¸­à¹ˆà¸­à¸™à¹€à¸žà¸¥à¸µà¸¢ ðŸ¥±", description: "à¸„à¸°à¹à¸™à¸™à¸™à¸µà¹‰à¹ƒà¸«à¹‰à¹à¸šà¸šà¸«à¸¡à¸”à¹à¸£à¸‡... à¹€à¸«à¸¡à¸·à¸­à¸™à¸Šà¸µà¸§à¸´à¸•à¸¡à¸±à¸™à¹à¸šà¸•à¸«à¸¡à¸”!" },
        { type: "à¸”à¹‰à¸§à¸¢à¸„à¸§à¸²à¸¡à¸à¸£à¹‰à¸²à¸§à¹ƒà¸ˆ ðŸ”¥", description: "à¸„à¸°à¹à¸™à¸™à¸™à¸µà¹‰à¸à¸£à¹‰à¸²à¸§à¹ƒà¸ˆà¹€à¸«à¸¡à¸·à¸­à¸™à¸Šà¹‡à¸­à¸•à¹„à¸Ÿà¸Ÿà¹‰à¸²! à¸£à¸±à¸šà¹„à¸›à¸ªà¸°à¸”à¸¸à¹‰à¸‡à¸à¸±à¸™à¹„à¸›à¹€à¸¥à¸¢!" },
        { type: "à¸”à¹‰à¸§à¸¢à¸„à¸§à¸²à¸¡à¸Ÿà¸£à¸¸à¹‰à¸‡à¸Ÿà¸£à¸´à¹‰à¸‡ ðŸŒ¸", description: "à¸„à¸°à¹à¸™à¸™à¸™à¸µà¹‰à¸¡à¸²à¸žà¸£à¹‰à¸­à¸¡à¸à¸¥à¸´à¹ˆà¸™à¸«à¸­à¸¡à¸‚à¸­à¸‡à¸”à¸­à¸à¹„à¸¡à¹‰ à¹‚à¸£à¹à¸¡à¸™à¸•à¸´à¸à¸ªà¸¸à¸”à¹†!" },
        { type: "à¸”à¹‰à¸§à¸¢à¸„à¸§à¸²à¸¡à¸«à¸¡à¸±à¹ˆà¸™à¹€à¸‚à¸µà¹‰à¸¢à¸§ ðŸ¾", description: "à¸™à¹ˆà¸²à¸£à¸±à¸à¹€à¸à¸´à¸™à¹„à¸›à¸¥à¸°! à¸£à¸±à¸šà¸„à¸°à¹à¸™à¸™à¸™à¸µà¹‰à¹„à¸›à¹à¸šà¸šà¸«à¸¡à¸±à¹ˆà¸™à¹€à¸‚à¸µà¹‰à¸¢à¸§à¸ªà¸¸à¸”à¹†!" },
        { type: "à¸”à¹‰à¸§à¸¢à¸„à¸§à¸²à¸¡à¸žà¸£à¸´à¹‰à¸§à¹„à¸«à¸§ ðŸŒŠ", description: "à¸„à¸°à¹à¸™à¸™à¸™à¸µà¹‰à¹„à¸«à¸¥à¹€à¸«à¸¡à¸·à¸­à¸™à¸™à¹‰à¸³à¹ƒà¸™à¹à¸¡à¹ˆà¸™à¹‰à¸³... à¹ƒà¸«à¹‰à¹à¸šà¸šà¹„à¸¡à¹ˆà¸¡à¸µà¸•à¸´à¸”à¸‚à¸±à¸”!" },
        { type: "à¸”à¹‰à¸§à¸¢à¸„à¸§à¸²à¸¡à¸šà¹‰à¸²à¸£à¸°à¸«à¹ˆà¸³ ðŸ´â€â˜ ï¸", description: "à¸„à¸°à¹à¸™à¸™à¸™à¸µà¹‰à¹€à¸«à¸¡à¸·à¸­à¸™à¹‚à¸ˆà¸£à¸ªà¸¥à¸±à¸”à¹à¸ˆà¸à¸ªà¸¡à¸šà¸±à¸•à¸´! à¸¥à¸¸à¸¢à¹„à¸›à¹€à¸¥à¸¢!" },
        { type: "à¸”à¹‰à¸§à¸¢à¸„à¸§à¸²à¸¡à¸‹à¸¶à¹‰à¸‡à¹ƒà¸ˆ ðŸ˜­", description: "à¸„à¸°à¹à¸™à¸™à¸™à¸µà¹‰à¸¡à¸²à¸žà¸£à¹‰à¸­à¸¡à¸™à¹‰à¸³à¸•à¸²à¹„à¸«à¸¥à¸žà¸£à¸²à¸ à¸‚à¸­à¸šà¸„à¸¸à¸“à¸¡à¸²à¸à¹€à¸¥à¸¢à¸™à¸°!" },
        { type: "à¸”à¹‰à¸§à¸¢à¸„à¸§à¸²à¸¡à¸‹à¹ˆà¸²à¸ªà¹Œ ðŸ»", description: "à¸„à¸°à¹à¸™à¸™à¸™à¸µà¹‰à¸‹à¹ˆà¸²à¸ªà¹Œà¹€à¸«à¸¡à¸·à¸­à¸™à¸™à¹‰à¸³à¸­à¸±à¸”à¸¥à¸¡! à¸Ÿà¸¹à¹ˆà¸Ÿà¹ˆà¸²à¸à¸±à¸™à¹„à¸›à¹€à¸¥à¸¢!" },
        { type: "à¸”à¹‰à¸§à¸¢à¸„à¸§à¸²à¸¡à¸£à¹‡à¸­à¸„ ðŸ¤˜", description: "à¸„à¸°à¹à¸™à¸™à¸™à¸µà¹‰à¸à¸£à¸°à¹à¸—à¸à¹ƒà¸ˆà¹€à¸«à¸¡à¸·à¸­à¸™à¹€à¸ªà¸µà¸¢à¸‡à¸à¸µà¸•à¸²à¸£à¹Œà¹„à¸Ÿà¸Ÿà¹‰à¸²! à¸£à¹‡à¸­à¸„à¸¡à¸±à¸™à¸ªà¹Œà¹„à¸›à¹€à¸¥à¸¢!" },
        { type: "à¸”à¹‰à¸§à¸¢à¸„à¸§à¸²à¸¡à¸ªà¸²à¸¢à¸¥à¸¸à¸¢ ðŸž", description: "à¸„à¸°à¹à¸™à¸™à¸™à¸µà¹‰à¸¡à¸²à¸žà¸£à¹‰à¸­à¸¡à¸£à¸­à¸‡à¹€à¸—à¹‰à¸²à¸œà¹‰à¸²à¹ƒà¸š! à¸žà¸£à¹‰à¸­à¸¡à¸¥à¸¸à¸¢à¸—à¸¸à¸à¸ªà¸–à¸²à¸™à¸à¸²à¸£à¸“à¹Œ!" },
        { type: "à¸”à¹‰à¸§à¸¢à¸„à¸§à¸²à¸¡à¸”à¸£à¸²à¸¡à¹ˆà¸² ðŸŽ¬", description: "à¸„à¸°à¹à¸™à¸™à¸™à¸µà¹‰à¹€à¸«à¸¡à¸·à¸­à¸™à¸‹à¸µà¸™à¹ƒà¸™à¸«à¸™à¸±à¸‡à¸™à¹‰à¸³à¸•à¸²à¹à¸•à¸! à¹ƒà¸«à¹‰à¹à¸šà¸šà¸ªà¸¸à¸”à¸žà¸µà¸„!" }
    ];

    const fetchUsers = async () => {
        setIsLoading(true);
        try {
            const businessId = currentUser?.currentUser?.businessId;
            const status = 1;

            const response = await fetchProtectedData.get(
                `${URLS.users.getAll}`,
                {
                    params: { businessId, status },
                }
            );

            const filteredUsers = response.data.filter(
                (user) => user.username !== currentUser?.currentUser?.userName
            );

            setUsers(filteredUsers);
        } catch (error) {
            console.error('Error fetching users:', error);
        } finally {
            setIsLoading(false);
        }
    };

    const fetchLastestTransfers = async () => {
        setIsLoadingLastestTransfers(true);
        try {
            const response = await fetchProtectedData.get(`${URLS.weOne.getLatestTransfers}`, {
                params: { sender_username: currentUser?.currentUser?.userName },
            });

            if (response.status === 200 && response.data?.data) {
                const filteredUsers = response.data.data.filter(
                    (transfer) => transfer.receiver_username !== currentUser?.currentUser?.userName
                );

                setLastestTransfers(filteredUsers);
            } else {
                setLastestTransfers([]);
            }
        } catch (error) {
            console.error('Error fetching latest transfers:', error);
            setLastestTransfers([]);
        } finally {
            setIsLoadingLastestTransfers(false);
        }
    };

    useEffect(() => {
        if (currentUser?.currentUser?.businessId) {
            fetchUsers();
        }

        if (currentUser?.currentUser?.userName) {
            fetchLastestTransfers();
        }
    }, [currentUser]);


    const fetchUserPoints = async () => {
        setIsLoadingPoints(true);
        try {
            const response = await fetchProtectedData.get(`${URLS.weOne.getUserPoints}`, {
                params: { username: currentUser.currentUser.userName },
            });

            if (response.status === 200) {
                setUserPoints(response.data);
            }
        } catch (error) {
            console.error('Error fetching user points:', error);
        } finally {
            setIsLoadingPoints(false);
        }
    };

    useEffect(() => {
        if (currentUser?.currentUser?.userName) {
            fetchUserPoints();
        }
    }, [currentUser]);

    return (
        <TransferContext.Provider
            value={{
                selectedUsers,
                setSelectedUsers,
                selectedRemark,
                setSelectedRemark,
                users,
                isLoading,
                fetchUsers,
                remarks,
                userPoints,
                isLoadingPoints,
                fetchUserPoints,
                lastestTransfers, // State à¹ƒà¸«à¹‰ Components à¸­à¸·à¹ˆà¸™à¹ƒà¸Šà¹‰
                isLoadingLastestTransfers, // à¸ªà¸–à¸²à¸™à¸° Loading
                fetchLastestTransfers, // à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™ Fetch Lastest
            }}
        >
            {children}
        </TransferContext.Provider>
    );
};

export const useTransfer = () => {
    return useContext(TransferContext);
};
