import React, { createContext, useContext, useState, useEffect } from 'react';
import fetchProtectedData from '../../../../utils/fetchData';
import { useAppContext } from '../../../contexts/AppContext';
import { URLS } from '../../../config';

const TransferContext = createContext();

export const TransferProvider = ({ children }) => {
    const [selectedUsers, setSelectedUsers] = useState([]);
    const [selectedRemark, setSelectedRemark] = useState('');
    const [users, setUsers] = useState([]);
    const [isLoading, setIsLoading] = useState(false);
    const [userPoints, setUserPoints] = useState({ total_points: 0, total_coins: 0 });
    const [isLoadingPoints, setIsLoadingPoints] = useState(false);
    const [lastestTransfers, setLastestTransfers] = useState([]); // State ‡πÉ‡∏´‡∏°‡πà
    const [isLoadingLastestTransfers, setIsLoadingLastestTransfers] = useState(false);
    const currentUser = useAppContext();

    const remarks = [
        { type: "‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏Å üíò", description: "‡πÑ‡∏ü‡∏£‡∏±‡∏Å‡∏°‡∏±‡∏ô‡∏£‡πâ‡∏≠‡∏ô‡πÅ‡∏£‡∏á‡∏à‡∏ô‡∏•‡∏ß‡∏Å‡∏´‡∏±‡∏ß‡πÉ‡∏à! ‡∏ô‡πâ‡∏≥‡∏ó‡∏∞‡πÄ‡∏•‡∏Å‡πá‡∏¢‡∏±‡∏á‡∏î‡∏±‡∏ö‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ ‡∏´‡∏ß‡∏≤‡∏ô‡πÄ‡∏à‡∏µ‡πä‡∏¢‡∏ö!" },
        { type: "‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏ö‡∏∑‡πà‡∏≠ ü•¥", description: "‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡∏°‡∏±‡∏ô‡πÄ‡∏ã‡πá‡∏á‡πÄ‡∏Å‡∏¥‡∏ô‡∏ö‡∏£‡∏£‡∏¢‡∏≤‡∏¢ ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏Å‡πá‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏Å‡∏≠‡∏á‡∏ú‡∏±‡∏Å ‡πÑ‡∏°‡πà‡∏£‡∏π‡πâ‡∏à‡∏∞‡∏™‡∏ô‡πÉ‡∏à‡πÑ‡∏õ‡∏ó‡∏≥‡πÑ‡∏°!" },
        { type: "‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡πà‡∏≤‡∏¢‡πÅ‡∏û‡πâ ü§ï", description: "‡πÅ‡∏û‡πâ‡πÅ‡∏•‡πâ‡∏ß‡πÑ‡∏á? ‡πÑ‡∏°‡πà‡∏£‡πâ‡∏≠‡∏á‡∏´‡∏£‡∏≠‡∏Å ‡πÅ‡∏Ñ‡πà‡∏´‡∏±‡∏ß‡πÉ‡∏à‡∏´‡∏±‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡πÜ ‡πÄ‡∏≠‡∏á... ‡πÄ‡∏à‡πá‡∏ö‡∏à‡∏µ‡πä‡∏î‡πÄ‡∏•‡∏¢!" },
        { type: "‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏ö‡∏™‡∏ô ü§Ø", description: "‡∏ô‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏ó‡∏≥‡∏≠‡∏∞‡πÑ‡∏£‡∏≠‡∏¢‡∏π‡πà? ‡∏´‡∏•‡∏á‡∏°‡∏≤‡πÅ‡∏ö‡∏ö‡∏á‡∏á‡πÜ ‡πÅ‡∏ï‡πà‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡πá‡∏¢‡∏±‡∏á‡∏´‡∏≤‡∏¢‡πÉ‡∏à‡∏≠‡∏¢‡∏π‡πà‡∏•‡∏∞‡∏Å‡∏±‡∏ô!" },
        { type: "‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏¥‡∏ô‡∏î‡∏µ ü•≥", description: "‡πÄ‡∏Æ‡πâ‡∏¢! ‡∏î‡∏µ‡πÉ‡∏à‡πÅ‡∏ö‡∏ö‡πÑ‡∏°‡πà‡πÑ‡∏´‡∏ß‡πÅ‡∏•‡πâ‡∏ß ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏ñ‡∏π‡∏Å‡∏´‡∏ß‡∏¢‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏ó‡∏µ‡πà 1 ‡πÅ‡∏ï‡πà‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏•‡∏Ç‡∏ö‡∏≠‡∏Å!" },
        { type: "‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏´‡πá‡∏ô‡πÉ‡∏à üòî", description: "‡∏°‡∏≤‡∏ô‡∏µ‡πà‡∏°‡∏≤ ‡πÉ‡∏´‡πâ‡∏Å‡∏≠‡∏î‡∏ó‡∏µ! ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡∏°‡∏±‡∏ô‡πÑ‡∏°‡πà‡∏á‡πà‡∏≤‡∏¢ ‡πÅ‡∏ï‡πà‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏ó‡∏¥‡πâ‡∏á‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡∏ô‡∏≠‡∏ô!" },
        { type: "‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡∏ä‡∏î‡∏õ‡∏£‡∏∞‡∏ä‡∏±‡∏ô üòè", description: "‡∏≠‡πâ‡∏≠ ‡πÄ‡∏Å‡πà‡∏á‡∏ô‡∏∞? ‡πÄ‡∏Å‡πà‡∏á‡∏à‡∏£‡∏¥‡∏á‡πÜ ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏≠‡∏∞‡πÑ‡∏£‡πÅ‡∏ö‡∏ö‡∏ô‡∏µ‡πâ ‡∏Ñ‡∏ô‡∏£‡∏ß‡∏¢‡πÑ‡∏°‡πà‡πÅ‡∏Ñ‡∏£‡πå‡∏´‡∏£‡∏≠‡∏Å! ‡∏´‡∏∂!" },
        { type: "‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πà‡∏ô‡∏ä‡∏° ‚ú®", description: "‡∏™‡∏∏‡∏î‡∏õ‡∏±‡∏á‡πÑ‡∏õ‡πÄ‡∏•‡∏¢‡πÅ‡∏°‡πà! ‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏∑‡∏≠‡πÑ‡∏ü‡∏•‡∏∏‡∏Å‡∏û‡∏£‡∏∂‡πà‡∏ö‡∏Å‡∏•‡∏≤‡∏á‡πÄ‡∏ß‡∏ó‡∏µ ‡∏ä‡∏ô‡∏∞‡πÉ‡∏à‡πÑ‡∏õ‡πÄ‡∏•‡∏¢‡∏™‡∏¥‡∏Ñ‡∏∞!" },
        { type: "‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ç‡∏µ‡πâ‡πÄ‡∏Å‡∏µ‡∏¢‡∏à üò¥", description: "‡∏ï‡∏∑‡πà‡∏ô‡∏°‡∏≤‡∏ó‡∏≥‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏¢‡∏±‡∏á‡πÄ‡∏´‡∏ô‡∏∑‡πà‡∏≠‡∏¢‡πÄ‡∏•‡∏¢ ‡∏Ç‡∏≠‡πÅ‡∏õ‡πä‡∏ö‡∏´‡∏ô‡∏∂‡πà‡∏á‡∏ô‡∏∞! ‡πÄ‡∏´‡∏ô‡∏∑‡πà‡∏≠‡∏¢‡∏°‡∏≤‡∏Å‡∏à‡∏£‡∏¥‡∏á‡πÜ!" },
        { type: "‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏¥‡∏ß‡πÇ‡∏´‡∏¢ üçî", description: "‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏≠‡∏∞‡πÑ‡∏£‡πÑ‡∏°‡πà‡∏£‡∏π‡πâ ‡πÅ‡∏ï‡πà‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡∏≠‡∏¢‡∏≤‡∏Å‡∏Å‡∏¥‡∏ô‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÄ‡∏Å‡∏≠‡∏£‡πå‡∏°‡∏≤‡∏Å‡∏Å‡∏Å!" },
        { type: "‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏±‡πà‡∏ô‡πÑ‡∏™‡πâ üôÑ", description: "‡∏´‡∏∂ ‡πÄ‡∏Å‡πà‡∏á‡πÄ‡∏ô‡∏≠‡∏∞! ‡πÅ‡∏à‡∏Å‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÅ‡∏ö‡∏ö‡πÑ‡∏°‡πà‡∏Ñ‡∏¥‡∏î‡πÄ‡∏•‡∏¢... ‡∏´‡∏°‡∏±‡πà‡∏ô‡πÑ‡∏™‡πâ‡∏°‡∏≤‡∏Å!" },
        { type: "‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏∞‡∏ó‡∏∂‡∏Å‡πÉ‡∏à üò¨", description: "‡∏ô‡∏µ‡πà‡∏°‡∏±‡∏ô‡πÄ‡∏Å‡∏°‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï! ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏û‡∏•‡∏¥‡∏Å‡∏ä‡∏∞‡∏ï‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡∏û‡∏±‡∏á‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡πá‡πÑ‡∏î‡πâ!" },
        { type: "‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡∏¢‡∏î‡∏≤‡∏¢ ü•π", description: "‡πÇ‡∏ñ‡πà! ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏´‡∏≤‡∏¢‡πÑ‡∏õ‡πÉ‡∏ô‡∏≠‡∏≤‡∏Å‡∏≤‡∏® ‡∏à‡∏∞‡∏£‡πâ‡∏≠‡∏á‡πÑ‡∏´‡πâ‡πÅ‡∏•‡πâ‡∏ß!" },
        { type: "‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏≠‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏£ ‚ú®", description: "‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ô‡∏µ‡πâ‡∏¢‡∏¥‡πà‡∏á‡πÉ‡∏´‡∏ç‡πà‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏õ‡∏£‡∏≤‡∏™‡∏≤‡∏ó‡πÄ‡∏•‡∏¢! ‡∏°‡∏µ‡∏ï‡∏±‡∏á‡∏Ñ‡πå‡∏Å‡πá‡πÅ‡∏à‡∏Å‡πÜ ‡πÑ‡∏õ‡∏™‡∏¥!" },
        { type: "‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ç‡∏µ‡πâ‡πÄ‡∏•‡πà‡∏ô üòú", description: "‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏≠‡∏∞‡πÑ‡∏£‡∏à‡∏£‡∏¥‡∏á‡∏à‡∏±‡∏á! ‡πÅ‡∏Ñ‡πà‡πÉ‡∏´‡πâ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏≠‡∏¢‡∏≤‡∏Å‡πÅ‡∏Å‡∏•‡πâ‡∏á!" },
        { type: "‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡∏ñ‡∏∂‡∏á ü•π", description: "‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ô‡∏µ‡πâ‡∏™‡πà‡∏á‡∏°‡∏≤‡πÉ‡∏´‡πâ ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏Ñ‡∏¥‡∏î‡∏ñ‡∏∂‡∏á‡πÅ‡∏ö‡∏ö‡∏™‡∏∏‡∏î‡∏´‡∏±‡∏ß‡πÉ‡∏à!" },
        { type: "‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏∏‡πâ‡∏ô‡∏£‡∏∞‡∏ó‡∏∂‡∏Å üé≤", description: "‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏û‡∏ô‡∏±‡∏ô ‡πÑ‡∏°‡πà‡∏£‡∏π‡πâ‡∏à‡∏∞‡∏£‡∏≠‡∏î‡πÑ‡∏´‡∏° ‡πÅ‡∏ï‡πà‡∏•‡∏∏‡πâ‡∏ô‡∏ó‡∏∏‡∏Å‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ!" },
        { type: "‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡∏∑‡πà‡∏ô‡πÄ‡∏ï‡πâ‡∏ô üöÄ", description: "‡πÇ‡∏≠‡πÇ‡∏´! ‡∏ï‡∏∑‡πà‡∏ô‡πÄ‡∏ï‡πâ‡∏ô‡πÅ‡∏ö‡∏ö‡∏ô‡∏µ‡πâ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô‡∏à‡∏£‡∏ß‡∏î‡πÑ‡∏õ‡∏î‡∏≤‡∏ß‡∏≠‡∏±‡∏á‡∏Ñ‡∏≤‡∏£‡πÄ‡∏•‡∏¢!" },
        { type: "‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏≠‡∏¥‡πà‡∏°‡πÄ‡∏≠‡∏° ü•∞", description: "‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÑ‡∏≠‡∏ï‡∏¥‡∏°‡∏´‡∏ß‡∏≤‡∏ô‡πÄ‡∏¢‡πá‡∏ô ‡∏ä‡∏∑‡πà‡∏ô‡πÉ‡∏à‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î!" },
        { type: "‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏∂‡∏ô‡∏á‡∏á ü§î", description: "‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ô‡∏µ‡πâ‡∏°‡∏≤‡∏à‡∏≤‡∏Å‡πÑ‡∏´‡∏ô? ‡∏≠‡∏∑‡∏°... ‡∏Ñ‡∏¥‡∏î‡πÑ‡∏°‡πà‡∏≠‡∏≠‡∏Å ‡πÅ‡∏ï‡πà‡∏ß‡πà‡∏≤‡πÄ‡∏≠‡∏≤‡πÑ‡∏õ!" },
        { type: "‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏ß‡∏¢‡∏•‡πâ‡∏ô üíé", description: "‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏®‡∏©‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏≠‡∏ô... ‡πÅ‡∏à‡∏Å‡πÄ‡∏•‡πà‡∏ô‡πÜ ‡πÑ‡∏°‡πà‡∏Ñ‡∏¥‡∏î‡∏°‡∏≤‡∏Å!" },
        { type: "‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏≠‡∏¥‡∏ô‡∏î‡∏µ‡πâ üß¢", description: "‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ô‡∏µ‡πâ‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ï‡∏±‡∏ß ‡πÄ‡∏≠‡∏≤‡πÑ‡∏õ‡πÄ‡∏•‡∏¢ ‡πÅ‡∏ï‡πà‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ó‡∏≤‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à!" },
        { type: "‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Æ‡∏∂‡∏Å‡πÄ‡∏´‡∏¥‡∏° üí™", description: "‡πÑ‡∏ü‡πÉ‡∏ô‡∏ï‡∏±‡∏ß‡∏°‡∏±‡∏ô‡∏•‡∏∏‡∏Å‡πÇ‡∏ä‡∏ô! ‡πÅ‡∏à‡∏Å‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÅ‡∏ö‡∏ö‡πÑ‡∏°‡πà‡πÅ‡∏Ñ‡∏£‡πå‡πÇ‡∏•‡∏Å!" },
        { type: "‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏ú‡πá‡∏î üå∂", description: "‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏ú‡πá‡∏î‡∏£‡πâ‡∏≠‡∏ô‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏û‡∏£‡∏¥‡∏Å‡∏™‡∏¥‡∏ö‡πÄ‡∏°‡πá‡∏î! ‡∏£‡∏±‡∏ö‡πÑ‡∏õ‡∏ã‡∏µ‡πâ‡∏î‡πÄ‡∏•‡∏¢!" },
        { type: "‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ç‡∏ô‡∏•‡∏∏‡∏Å ü´£", description: "‡πÇ‡∏≠‡πâ‡πÇ‡∏´! ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ô‡∏µ‡πâ‡∏ó‡∏≥‡πÄ‡∏≠‡∏≤‡∏Ç‡∏ô‡∏•‡∏∏‡∏Å‡πÄ‡∏Å‡∏£‡∏µ‡∏¢‡∏ß‡πÄ‡∏•‡∏¢... ‡∏£‡∏±‡∏ö‡πÑ‡∏õ‡πÅ‡∏ö‡∏ö‡∏á‡∏á‡πÜ!" },
        { type: "‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏ß‡∏¥‡πà‡∏ô‡πÄ‡∏ß‡πâ‡∏≠ üé≠", description: "‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ô‡∏µ‡πâ‡∏°‡∏≤‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏ß‡∏¥‡πà‡∏ô‡πÄ‡∏ß‡πâ‡∏≠‡∏à‡∏ô‡πÄ‡∏Å‡∏¥‡∏ô‡πÄ‡∏ö‡∏≠‡∏£‡πå ‡πÅ‡∏Ñ‡πà‡πÉ‡∏´‡πâ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏ß‡πà‡∏≤‡∏á‡∏à‡∏±‡∏î!" },
        { type: "‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ö‡πâ‡∏≤‡∏ö‡∏≠ ü§™", description: "‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•! ‡πÅ‡∏Ñ‡πà‡∏ö‡πâ‡∏≤‡∏Å‡πá‡πÅ‡∏à‡∏Å!" },
        { type: "‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏á‡∏™‡∏±‡∏¢ ü§®", description: "‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ô‡∏µ‡πâ‡πÅ‡∏à‡∏Å‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß‡∏ó‡∏≥‡πÑ‡∏°‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏à‡∏Å? ‡πÅ‡∏ï‡πà‡∏Å‡πá‡πÅ‡∏à‡∏Å‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß!" },
        { type: "‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏≠‡πà‡∏≠‡∏ô‡πÄ‡∏û‡∏•‡∏µ‡∏¢ ü•±", description: "‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ô‡∏µ‡πâ‡πÉ‡∏´‡πâ‡πÅ‡∏ö‡∏ö‡∏´‡∏°‡∏î‡πÅ‡∏£‡∏á... ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡∏°‡∏±‡∏ô‡πÅ‡∏ö‡∏ï‡∏´‡∏°‡∏î!" },
        { type: "‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏£‡πâ‡∏≤‡∏ß‡πÉ‡∏à üî•", description: "‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ô‡∏µ‡πâ‡∏Å‡∏£‡πâ‡∏≤‡∏ß‡πÉ‡∏à‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏ä‡πá‡∏≠‡∏ï‡πÑ‡∏ü‡∏ü‡πâ‡∏≤! ‡∏£‡∏±‡∏ö‡πÑ‡∏õ‡∏™‡∏∞‡∏î‡∏∏‡πâ‡∏á‡∏Å‡∏±‡∏ô‡πÑ‡∏õ‡πÄ‡∏•‡∏¢!" },
        { type: "‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ü‡∏£‡∏∏‡πâ‡∏á‡∏ü‡∏£‡∏¥‡πâ‡∏á üå∏", description: "‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ô‡∏µ‡πâ‡∏°‡∏≤‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏•‡∏¥‡πà‡∏ô‡∏´‡∏≠‡∏°‡∏Ç‡∏≠‡∏á‡∏î‡∏≠‡∏Å‡πÑ‡∏°‡πâ ‡πÇ‡∏£‡πÅ‡∏°‡∏ô‡∏ï‡∏¥‡∏Å‡∏™‡∏∏‡∏î‡πÜ!" },
        { type: "‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏±‡πà‡∏ô‡πÄ‡∏Ç‡∏µ‡πâ‡∏¢‡∏ß üêæ", description: "‡∏ô‡πà‡∏≤‡∏£‡∏±‡∏Å‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ‡∏•‡∏∞! ‡∏£‡∏±‡∏ö‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ô‡∏µ‡πâ‡πÑ‡∏õ‡πÅ‡∏ö‡∏ö‡∏´‡∏°‡∏±‡πà‡∏ô‡πÄ‡∏Ç‡∏µ‡πâ‡∏¢‡∏ß‡∏™‡∏∏‡∏î‡πÜ!" },
        { type: "‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏£‡∏¥‡πâ‡∏ß‡πÑ‡∏´‡∏ß üåä", description: "‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ô‡∏µ‡πâ‡πÑ‡∏´‡∏•‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏ô‡πâ‡∏≥‡πÉ‡∏ô‡πÅ‡∏°‡πà‡∏ô‡πâ‡∏≥... ‡πÉ‡∏´‡πâ‡πÅ‡∏ö‡∏ö‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ï‡∏¥‡∏î‡∏Ç‡∏±‡∏î!" },
        { type: "‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ö‡πâ‡∏≤‡∏£‡∏∞‡∏´‡πà‡∏≥ üè¥‚Äç‚ò†Ô∏è", description: "‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÇ‡∏à‡∏£‡∏™‡∏•‡∏±‡∏î‡πÅ‡∏à‡∏Å‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥! ‡∏•‡∏∏‡∏¢‡πÑ‡∏õ‡πÄ‡∏•‡∏¢!" },
        { type: "‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ã‡∏∂‡πâ‡∏á‡πÉ‡∏à üò≠", description: "‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ô‡∏µ‡πâ‡∏°‡∏≤‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡πÑ‡∏´‡∏•‡∏û‡∏£‡∏≤‡∏Å ‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏°‡∏≤‡∏Å‡πÄ‡∏•‡∏¢‡∏ô‡∏∞!" },
        { type: "‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ã‡πà‡∏≤‡∏™‡πå üçª", description: "‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ô‡∏µ‡πâ‡∏ã‡πà‡∏≤‡∏™‡πå‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏ô‡πâ‡∏≥‡∏≠‡∏±‡∏î‡∏•‡∏°! ‡∏ü‡∏π‡πà‡∏ü‡πà‡∏≤‡∏Å‡∏±‡∏ô‡πÑ‡∏õ‡πÄ‡∏•‡∏¢!" },
        { type: "‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πá‡∏≠‡∏Ñ ü§ò", description: "‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ô‡∏µ‡πâ‡∏Å‡∏£‡∏∞‡πÅ‡∏ó‡∏Å‡πÉ‡∏à‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏Å‡∏µ‡∏ï‡∏≤‡∏£‡πå‡πÑ‡∏ü‡∏ü‡πâ‡∏≤! ‡∏£‡πá‡∏≠‡∏Ñ‡∏°‡∏±‡∏ô‡∏™‡πå‡πÑ‡∏õ‡πÄ‡∏•‡∏¢!" },
        { type: "‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏¢‡∏•‡∏∏‡∏¢ üèû", description: "‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ô‡∏µ‡πâ‡∏°‡∏≤‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏£‡∏≠‡∏á‡πÄ‡∏ó‡πâ‡∏≤‡∏ú‡πâ‡∏≤‡πÉ‡∏ö! ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏•‡∏∏‡∏¢‡∏ó‡∏∏‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå!" },
        { type: "‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏£‡∏≤‡∏°‡πà‡∏≤ üé¨", description: "‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏ã‡∏µ‡∏ô‡πÉ‡∏ô‡∏´‡∏ô‡∏±‡∏á‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡πÅ‡∏ï‡∏Å! ‡πÉ‡∏´‡πâ‡πÅ‡∏ö‡∏ö‡∏™‡∏∏‡∏î‡∏û‡∏µ‡∏Ñ!" }
    ];

    const fetchUsers = async () => {
        setIsLoading(true);
        try {
            const businessId = currentUser?.currentUser?.businessId;
            const status = 1;

            const response = await fetchProtectedData.get(
                `${URLS.users.getAll}`,
                {
                    params: { businessId, status },
                }
            );

            const filteredUsers = response.data.filter(
                (user) => user.username !== currentUser?.currentUser?.userName
            );

            setUsers(filteredUsers);
        } catch (error) {
            console.error('Error fetching users:', error);
        } finally {
            setIsLoading(false);
        }
    };

    const fetchLastestTransfers = async () => {
        setIsLoadingLastestTransfers(true);
        try {
            const response = await fetchProtectedData.get(`${URLS.weOne.getLatestTransfers}`, {
                params: { sender_username: currentUser?.currentUser?.userName },
            });

            if (response.status === 200 && response.data?.data) {
                const filteredUsers = response.data.data.filter(
                    (transfer) => transfer.receiver_username !== currentUser?.currentUser?.userName
                );

                setLastestTransfers(filteredUsers);
            } else {
                setLastestTransfers([]);
            }
        } catch (error) {
            console.error('Error fetching latest transfers:', error);
            setLastestTransfers([]);
        } finally {
            setIsLoadingLastestTransfers(false);
        }
    };

    useEffect(() => {
        if (currentUser?.currentUser?.businessId) {
            fetchUsers();
        }

        if (currentUser?.currentUser?.userName) {
            fetchLastestTransfers();
        }
    }, [currentUser]);


    const fetchUserPoints = async () => {
        setIsLoadingPoints(true);
        try {
            const response = await fetchProtectedData.get(`${URLS.weOne.getUserPoints}`, {
                params: { username: currentUser.currentUser.userName },
            });

            if (response.status === 200) {
                setUserPoints(response.data);
            }
        } catch (error) {
            console.error('Error fetching user points:', error);
        } finally {
            setIsLoadingPoints(false);
        }
    };

    useEffect(() => {
        if (currentUser?.currentUser?.userName) {
            fetchUserPoints();
        }
    }, [currentUser]);

    return (
        <TransferContext.Provider
            value={{
                selectedUsers,
                setSelectedUsers,
                selectedRemark,
                setSelectedRemark,
                users,
                isLoading,
                fetchUsers,
                remarks,
                userPoints,
                isLoadingPoints,
                fetchUserPoints,
                lastestTransfers, // State ‡πÉ‡∏´‡πâ Components ‡∏≠‡∏∑‡πà‡∏ô‡πÉ‡∏ä‡πâ
                isLoadingLastestTransfers, // ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ Loading
                fetchLastestTransfers, // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô Fetch Lastest
            }}
        >
            {children}
        </TransferContext.Provider>
    );
};

export const useTransfer = () => {
    return useContext(TransferContext);
};
